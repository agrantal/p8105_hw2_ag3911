---
title: "p8105_hw2_ag3911"
output: github_document
---

#Problem 1: NYC Subway Transit 

##Read and Clean Data
*Keep line, station, name, station latitude/longitude, routes served, entry, vending, entrance type, and ADA compliance
*Convert entry variable from character (yes/no) to logical
```{r}
library(tidyverse)
getwd()
subway_data = read_csv("./hw2 data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
  janitor::clean_names() %>%
  select(-division, -exit_only, -staffing, -staff_hours, -ada_notes, -entrance_location, -entrance_longitude, -entrance_latitude, -station_location, -corner, -east_west_street, -north_south_street, -free_crossover) %>%
  mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE))
subway_data
```
This dataset contains the following variables: line, station name, station latitude/longitude, which of the 11 routes are served, entry (true/false), vending (yes/no), entrance type (elevator, stair, door), and ADA compliance (true/false). I omitted unnecessary variables using 'select' and recoded the entry variable from character to logical using 'mutate' and 'recode'. The resulting dataset is 1,868 rows x 19 columns. The data are not tidy because there are 11 variables for route when there should only be 2: one for the total number of routes and one for the route's identifying letter/number. 


##Q1: How many distinct stations are there? 
```{r}
nrow(distinct(subway_data, station_name, line))
```
There are 465 distinct stations. 

##Q2: How many stations are ADA compliant?
```{r}
subway_data %>%
    count(station_name, line, ada) %>% #selecting distinct stations
    filter(ada == "TRUE") %>% #filtering for ADA compliance
    summarise(n = n())
```
84 stations are ADA compliant. 


##Q3: What proportion of station entrances / exits without vending allow entrance?
```{r}
vending = filter(subway_data, vending == "NO")
mean(vending$entry == "TRUE")
```
37.7% of station entrances/exits without vending allow entrance. 

##Reformat data so that route number and route name are distinct variables

##Q4: After reformatting the data so that route number and route name are distinct variables, how many distinct stations serve the A train?
```{r}
tidy_subway_data = gather(subway_data, key = route_num, value = route_name, route1:route11)
# how to do this with nested %>% code? also, can't I now delete the route_num bc seems to have no purpose? 
tidy_subway_data

tidy_subway_data %>%
    count(station_name, line, route_name) %>%
    filter(route_name == "A") %>%
    summarise(n = n())
```
There are 60 distinct stations that serve the A train.

##Q5: After reformatting the data so that route number and route name are distinct variables, of the distinct stations that serve the A train, how many are ADA compliant? 

```{r}
tidy_subway_data %>%
    count(station_name, line, route_name, ada) %>%
    filter(route_name == "A") %>%
    filter(ada == "TRUE") %>%
    summarise(n = n())
```
Of the stations that serve the A train, 17 are ADA compliant. 


#Problem 2: Mr. Trashwheel 

##Read and Clean Mr. Trashwheel Sheet Data 
*specify the sheet in the Excel file
*omit columns containing notes
*omit rows that do not include dumpster-specific data
*round the number of sports balls to the nearest integer and convert the result to an integer variable (using as.integer)

```{r}
library(readxl)
trash_data = readxl::read_excel("./hw2 data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = "Mr. Trash Wheel", range = cell_cols(1:14)) %>%
  janitor::clean_names() %>%
  round(sports_balls) %>% 
  filter(dumpster != "NA") 
  
# how to convert from decimal to integer and change data type? it can't find object sports_balls!!!??
as.integer(trash_data, "sports_balls")
```

##Read and Clean 2016 and 2017 Precipitation Sheets Data 
*omit rows without precipitation data and add a variable year
*combine datasets and convert month to a character variable, use the variable 'month.name'
```{r}
precip_16_data = readxl::read_excel("./hw2 data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = "2016 Precipitation", skip = 2, col_names = FALSE) %>%
  janitor::clean_names() %>%
  rename(month = x_1, total_precip = x_2) %>%
  filter(month != "NA", total_precip != "NA") %>%
  mutate(year = 16) 
  
precip_17_data = readxl::read_excel("./hw2 data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = "2017 Precipitation", skip = 2, col_names = FALSE) %>%
  janitor::clean_names() %>%
  rename(month = x_1, total_precip = x_2) %>%
  mutate(year = 17) %>%
  filter(month != "NA", total_precip != "NA")

precip_joined = left_join(precip_17_data, precip_16_data, by = "month") %>%
  mutate(month.name = as.character(month))


#is this what the joined dataset is supposed to look like? then, how do i relabel month to words instead of numbers?? also, should I remove the variable year and add the year info to the total to make it read "2016 total precip" ??


  factor(month.name[MM], levels=month.name[1:12])
  
  transform(month, c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"))



```

###In a paragraph (use inline R), note the number of observations in both resulting datasets, and give examples of key variables. For available data, what was the total precipitation in 2017? What was the median number of sports balls in a dumpster in 2016?
```{r}
```



#Problem 3: Behavioral Risk Factors Surveillance System (BRFSS) for Selected Metropolitan Area Risk Trends (SMART), 2002-2010 

##Read and Clean BRFSS data
```{r}
# install.packages("devtools")
devtools::install_github("p8105/p8105.datasets")
```

###format the data to use appropriate variable names
```{r}
```

###exclude variables for class, topic, question, sample size, and everything from lower confidence limit to GeoLocation
```{r}
```

###structure data so that responses (excellent to poor) are variables taking the value of Data_value
```{r}
```

###create a new variable showing the proportion of responses that were “Excellent” or “Very Good”
```{r}
```


##How many unique locations are included in the dataset? Is every state represented? What state is observed the most?
```{r}
```

##In 2002, what is the median of the “Excellent” response value?
```{r}
```

##Make a histogram of “Excellent” response values in the year 2002.
```{r}
```

##Make a scatterplot showing the proportion of “Excellent” response values in New York County and Queens County (both in NY State) in each year from 2002 to 2010.
```{r}
```
















